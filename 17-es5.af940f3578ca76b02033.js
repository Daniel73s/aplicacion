function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,n,t){return n&&_defineProperties(e.prototype,n),t&&_defineProperties(e,t),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{IKMc:function(e,n,t){"use strict";t.r(n),t.d(n,"AddanuncioPageModule",(function(){return I}));var o=t("ofXK"),i=t("3Pt+"),a=t("TEn/"),r=t("tyNb"),c=t("mrSG"),s=t("nYR2"),u=t("fXoL"),l=t("OqH9"),b=t("Vaw3"),g=["ImageAnuncio"];function f(e,n){if(1&e&&(u.Lb(0,"img",17),u.Zb(1,"async")),2&e){var t=u.Yb();u.ec("src",u.ac(1,1,t.urlImage),u.lc)}}function p(e,n){1&e&&u.Lb(0,"img",18)}function d(e,n){if(1&e&&(u.Lb(0,"ion-progress-bar",19),u.Zb(1,"async")),2&e){var t=u.Yb();u.ec("value",u.ac(1,1,t.uploadPercent))}}function m(e,n){if(1&e&&(u.Nb(0,"small",20),u.pc(1),u.Mb()),2&e){var t=u.Yb();u.Ab(1),u.qc(t.getError("titulo"))}}function h(e,n){if(1&e&&(u.Nb(0,"small",20),u.pc(1),u.Mb()),2&e){var t=u.Yb();u.Ab(1),u.qc(t.getError("texto"))}}var v,M,y,C=[{path:"",component:(v=function(){function e(n,t,o,i,a,r){_classCallCheck(this,e),this.route=n,this.fb=t,this.anuncioservise=o,this.toastController=i,this.router=a,this.storage=r,this.fechacre=new Date,this.codvet=Number(this.route.snapshot.paramMap.get("codvet"))}return _createClass(e,[{key:"ngOnInit",value:function(){this.formInit()}},{key:"formInit",value:function(){this.formulario=this.fb.group({titulo:["",[i.j.required,i.j.maxLength(100)]],texto:["",[i.j.required,i.j.maxLength(500)]]})}},{key:"agregar",value:function(){var e=this,n=this.formulario.value;n.fechacre=this.fechacre,n.imagen=this.imagenAnuncio.nativeElement.value," "==n.imagen&&(n.imagen="https://firebasestorage.googleapis.com/v0/b/talleriii-4de86.appspot.com/o/anuncios%2Fdefault.jpg?alt=media&token=02e4e452-7184-476b-ae52-95dacd3e0525"),this.anuncioservise.addanuncio(n).then((function(n){return e.anuncioservise.addvetanuncio({codvet:e.codvet,codanuncio:n[0].codanuncio}).then((function(n){e.mensaje(n.mensaje),e.router.navigate(["/tabs/misanuncios/".concat(e.codvet)])}))})),this.formulario.reset()}},{key:"mensaje",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.toastController.create({message:e,duration:2e3});case 2:n.sent.present();case 3:case"end":return n.stop()}}),n,this)})))}},{key:"uploadFile",value:function(e){var n=this;if(e.target.files[0].size/1024>3e3)this.mensaje("Imagen Demaciado grande");else{var t=Math.random().toString(36).substring(2),o=e.target.files[0],i="/veterinarias/img_".concat(t),a=this.storage.ref(i),r=this.storage.upload(i,o);this.uploadPercent=r.percentageChanges(),r.snapshotChanges().pipe(Object(s.a)((function(){return n.urlImage=a.getDownloadURL()}))).subscribe()}}},{key:"getError",value:function(e){var n;return this.formulario.get(e).hasError("required")?n="campo requerido":this.formulario.get(e).hasError("maxlength")&&("titulo"==e?n="el titulo no debe pasar de 100 caracteres":"texto"==e&&(n="el texto no debe pasar de 500 caracteres")),n}}]),e}(),v.\u0275fac=function(e){return new(e||v)(u.Kb(r.a),u.Kb(i.a),u.Kb(l.a),u.Kb(a.gb),u.Kb(r.g),u.Kb(b.a))},v.\u0275cmp=u.Eb({type:v,selectors:[["app-addanuncio"]],viewQuery:function(e,n){var t;1&e&&u.uc(g,!0),2&e&&u.ic(t=u.Wb())&&(n.imagenAnuncio=t.first)},decls:40,vars:13,consts:[[3,"defaultHref"],["fixed",""],["size","12","size-lg","6"],[1,"container-imagen"],["alt","usuario",3,"src",4,"ngIf"],["src","https://firebasestorage.googleapis.com/v0/b/talleriii-4de86.appspot.com/o/anuncios%2Fdefault.jpg?alt=media&token=02e4e452-7184-476b-ae52-95dacd3e0525","alt","imagen veterinaria",4,"ngIf"],[3,"value",4,"ngIf"],[1,"fileUpload","botonImagen"],["type","file","size","3000","accept",".png, .jpg",1,"upload",3,"change"],[3,"formGroup"],["position","floating"],["formControlName","titulo"],["class","mensajeError",4,"ngIf"],["formControlName","texto"],["shape","round","size","block",3,"disabled","click"],["type","hidden",3,"value"],["ImageAnuncio",""],["alt","usuario",3,"src"],["src","https://firebasestorage.googleapis.com/v0/b/talleriii-4de86.appspot.com/o/anuncios%2Fdefault.jpg?alt=media&token=02e4e452-7184-476b-ae52-95dacd3e0525","alt","imagen veterinaria"],[3,"value"],[1,"mensajeError"]],template:function(e,n){1&e&&(u.Nb(0,"ion-header"),u.Nb(1,"ion-toolbar"),u.Nb(2,"ion-buttons"),u.Lb(3,"ion-back-button",0),u.Nb(4,"ion-title"),u.pc(5,"Adicionar anuncio"),u.Mb(),u.Mb(),u.Mb(),u.Mb(),u.Nb(6,"ion-content"),u.Nb(7,"ion-grid",1),u.Nb(8,"ion-row"),u.Nb(9,"ion-col",2),u.Nb(10,"div",3),u.nc(11,f,2,3,"img",4),u.Zb(12,"async"),u.nc(13,p,1,0,"img",5),u.nc(14,d,2,3,"ion-progress-bar",6),u.Nb(15,"div",7),u.Nb(16,"span"),u.pc(17,"Subir Imagen"),u.Mb(),u.Nb(18,"input",8),u.Vb("change",(function(e){return n.uploadFile(e)})),u.Mb(),u.Mb(),u.Mb(),u.Mb(),u.Nb(19,"ion-col",2),u.Nb(20,"form",9),u.Nb(21,"ion-list"),u.Nb(22,"ion-list-header"),u.Nb(23,"h3"),u.pc(24,"Adicionar Nuevo Anuncio"),u.Mb(),u.Mb(),u.Nb(25,"ion-item"),u.Nb(26,"ion-label",10),u.pc(27,"Titulo"),u.Mb(),u.Lb(28,"ion-input",11),u.Mb(),u.nc(29,m,2,1,"small",12),u.Nb(30,"ion-item"),u.Nb(31,"ion-label",10),u.pc(32,"Detalle"),u.Mb(),u.Lb(33,"ion-textarea",13),u.Mb(),u.nc(34,h,2,1,"small",12),u.Mb(),u.Nb(35,"ion-button",14),u.Vb("click",(function(){return n.agregar()})),u.pc(36," Crear "),u.Mb(),u.Mb(),u.Lb(37,"input",15,16),u.Zb(39,"async"),u.Mb(),u.Mb(),u.Mb(),u.Mb()),2&e&&(u.Ab(3),u.gc("defaultHref","/tabs/misanuncios/",n.codvet,""),u.Ab(8),u.ec("ngIf",u.ac(12,9,n.urlImage)),u.Ab(2),u.ec("ngIf",!n.urlImage),u.Ab(1),u.ec("ngIf",n.uploadPercent),u.Ab(6),u.ec("formGroup",n.formulario),u.Ab(9),u.ec("ngIf",n.formulario.get("titulo").touched),u.Ab(5),u.ec("ngIf",n.formulario.get("texto").touched),u.Ab(1),u.ec("disabled",n.formulario.invalid),u.Ab(2),u.ec("value",u.ac(39,11,n.urlImage)))},directives:[a.w,a.Y,a.i,a.f,a.g,a.W,a.r,a.v,a.J,a.q,o.m,i.k,i.h,i.c,a.E,a.F,a.z,a.D,a.y,a.fb,i.g,i.b,a.U,a.h,a.H],pipes:[o.b],styles:["*[_ngcontent-%COMP%]{font-family:Poppins,sans-serif}.container-imagen[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center;flex-direction:column}.container-imagen[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{width:100%;height:350px;-o-object-fit:cover;object-fit:cover;-o-object-position:center;object-position:center;border:2px solid #f3f2f2;padding:2px}.fileUpload[_ngcontent-%COMP%]{position:relative;overflow:hidden;margin:10px}.fileUpload[_ngcontent-%COMP%]   input.upload[_ngcontent-%COMP%]{position:absolute;top:0;right:0;margin:0;padding:0;font-size:20px;cursor:pointer;opacity:0;filter:alpha(opacity=0)}.botonImagen[_ngcontent-%COMP%]{padding:10px;background-color:var(--ion-color-tertiary);border-radius:5px}.botonImagen[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-weight:500}.mensajeError[_ngcontent-%COMP%]{color:red;padding:10px;border-radius:10px}"]}),v)}],N=((y=function e(){_classCallCheck(this,e)}).\u0275mod=u.Ib({type:y}),y.\u0275inj=u.Hb({factory:function(e){return new(e||y)},imports:[[r.i.forChild(C)],r.i]}),y),I=((M=function e(){_classCallCheck(this,e)}).\u0275mod=u.Ib({type:M}),M.\u0275inj=u.Hb({factory:function(e){return new(e||M)},imports:[[o.c,i.d,a.Z,N,i.i]]}),M)}}]);